flow {
  
  a = Reader("/tmp/");
  b = Reader($2);

  out_train = Writer("/tmp/");
  out_test = Writer("/tmp/");
  out_val = Writer("/tmp/");

  sum = OperationSum();
  split = OperationSplit(a=0.2,b=0.8,);
  split_by = OperationSplitByQuery(`a`);

  a -> sum;
  b -> sum;

  sum -> split_by;

  split_by:out[0] -> out_train;
  split_by:out[1] -> split;

  split:out[a] -> out_val;
  split:out[b] -> out_test;

}